<!-- Start Breadcrumbs -->
<app-breadcrumbs title="Other Cost" [breadcrumbItems]="breadCrumbItems"></app-breadcrumbs>
<!-- End Breadcrumbs -->

<div class="row">
    <div class="col-lg-12">
        <div class="card" id="OtherCostList">
            <div class="card-body">
                <div class="row align-items-center g-2">
                    <div class="col-lg-3 me-auto">
                        <div class="d-flex align-items-center">
                            <!-- <label>
                      <h4 _ngcontent-ng-c141272207="" class="card-title">Key Performance Indicators List
                      </h4>
                    </label> -->
                        </div>
                    </div>

                    <div class="col-lg-auto">
                        <div class="hstack flex-wrap gap-1">
                            <!-- <button class="btn btn-subtle-danger d-none" id="remove-actions"><i class="ri-delete-bin-2-line"></i></button> -->

                            <div _ngcontent-ng-c141272207="" class="">
                                <div _ngcontent-ng-c141272207="" class="search-box">
                                    <input _ngcontent-ng-c141272207="" type="text"
                                        placeholder="Search for Customer,Type,FC,Fx Rate"
                                        class="form-control search ng-pristine ng-valid ng-touched"
                                        [(ngModel)]="searchTerm" (keyup)="onSearchKeyUp(searchTerm)">
                                    <i _ngcontent-ng-c141272207="" class="ri-search-line search-icon"></i>
                                </div>
                            </div>

                            <button [hidden]="!menucanadd" name="{{menucanadd}}" type="button"
                                class="btn btn-primary add-btn" (click)="openModal()"><i
                                    class="bi bi-plus-circle align-baseline me-1"></i> Add Other Cost</button>
                            <button type="button" class="btn btn-info me-1" (click)="openEnd()"><i
                                    class="bi bi-funnel align-baseline me-1"></i> Filter</button>
                            <div>
                                <div dropdown class="btn-group">
                                    <button dropdownToggle class="btn btn-success me-1" type="button"
                                        id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                                        <i class="ph-cloud-arrow-up align-middle me-1"></i>
                                        Export
                                    </button>
                                    <ul *dropdownMenu class="dropdown-menu dropdown-menu-end dropdown-menu-lg-start"
                                        aria-labelledby="dropdownMenuButton">
                                        <li>
                                            <button class="dropdown-item btn-link" type="button"
                                                (click)="exportToExcel()">
                                                <i class="bi bi-filetype-xls fs-4 me-1"></i>
                                                <span>Excel</span>
                                            </button>
                                        </li>
                                        <li class="mt-1">
                                            <button class="dropdown-item btn-link" type="button"
                                                (click)="exportToCsv()">
                                                <i class="bi bi-filetype-csv fs-4 me-1"></i>
                                                <span>CSV</span>
                                            </button>
                                        </li>
                                        <li class="mt-1">
                                            <button class="dropdown-item btn-link" type="button"
                                                (click)="exportToPDF()">
                                                <i class="bi bi-filetype-pdf fs-4 me-1"></i>
                                                <span>PDF</span>
                                            </button>
                                        </li>
                                        <li class="mt-1">
                                            <button class="dropdown-item btn-link" type="button"
                                                (click)="exportToExcelAll()">
                                                <i class="bi bi-filetype-pdf fs-4 me-1"></i>
                                                <span>Excel All</span>
                                            </button>
                                        </li>
                                        <li class="mt-1">
                                            <button class="dropdown-item btn-link" type="button"
                                                (click)="exportToCsvAll()">
                                                <i class="bi bi-filetype-pdf fs-4 me-1"></i>
                                                <span>Csv All</span>
                                            </button>
                                        </li>
                                        <li class="mt-1">
                                            <button class="dropdown-item btn-link" type="button"
                                                 (click)="exportAllPdf()">
                                                 <i class="bi bi-filetype-pdf fs-4 me-1"></i>
                                                 <span>PDF All</span>
                                            </button>
                                       </li>

                                    </ul>
                                </div>
                                <div dropdown class="btn-group" [hidden]="!menucanupdate && !menucandelete">
                                    <button dropdownToggle class="btn btn-primary me-1" type="button"
                                        id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="true"
                                        [class.disabled]="!areMultipleRowsSelected()">
                                        <i class="bi bi-three-dots-vertical"></i>
                                    </button>
                                    <ul *dropdownMenu class="dropdown-menu" aria-labelledby="dropdownMenuButton">

                                        <li [hidden]="!menucanupdate" class="mt-1">
                                            <button class="dropdown-item btn-link" type="button" (click)="editList()"
                                                [disabled]="!isSingleRowSelected()">
                                                <i class="bi bi-pencil-square"></i> Edit
                                            </button>
                                        </li>
                                        <li [hidden]="!menucandelete" class="mt-1">
                                            <button class="dropdown-item btn-link" type="button"
                                                (click)="deleteRecordModal.show()" [disabled]="!isSingleRowSelected()">
                                                <i class="bi bi-trash"></i> Delete
                                            </button>
                                        </li>

                                    </ul>
                                </div>
                                
                                <div dropdown class="btn-group me-1" (click)="onDropdownClick($event)">
                                    <button dropdownToggle type="button" class="btn btn-subtle-danger"
                                        data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        <i class="mdi mdi-cog-outline text-muted fs-lg align-middle me-1"></i>
                                    </button>
                                    <div *dropdownMenu
                                        class="dropdown-menu dropdown-menu-end dropdown-menu-lg-start p-2"
                                        (click)="onDropdownMenuClick($event)">
                                        <label *ngFor="let item of columnDefinitions" class="dropdown-item">
                                            <input type="checkbox" [(ngModel)]="item.visible"
                                                (click)="onColumnToggleChange(item)" [disabled]="item.disableHide" />
                                            {{ item.label }}
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card-body">
                <div class="table-responsive table-card table-container">
                    <table class="table table-centered align-middle table-custom-effect table-nowrap mb-0">
                        <thead class="text-muted">
                            <tr>
                                <th>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" [(ngModel)]="masterSelected"
                                            (change)="checkUncheckAll($event)" />
                                        <label class="form-check-label"></label>
                                    </div>
                                </th>
                                <ng-container *ngFor="let column of columnDefinitions">
                                    <th class="sort cursor-pointer"
                                        [ngClass]="{ 'sort cursor-pointer': column.sortable }" *ngIf="column.visible"
                                        (click)="sort(column.def)">

                                        <span class="col-sm-auto"> {{ column.label }} </span>

                                        <span *ngIf="column.sortable"> </span>
                                        <div class="input-group input-group-sm" style="width: 100px"
                                            *ngIf="column.filterable">
                                        </div>
                                    </th>
                                </ng-container>
                            </tr>
                        </thead>
                        <tbody class="list form-check-all">
                            <tr *ngFor="let row of filteredItems()" [class.selected-row]="row.isSelected"
                                (click)="handleRowClick($event, row)">
                                <td>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" [(ngModel)]="row.state"
                                            [checked]="row.isSelected" (change)="onCheckboxChange($event, row)" />
                                        <label class="form-check-label"></label>
                                    </div>
                                </td>
                                <ng-container *ngFor="let column of columnDefinitions">
                                    <td *ngIf="column.isLink && column.visible">
                                        <a class="fw-medium link-primary"
                                            [routerLink]="['/purchase/consignment/edit/', row[column?.id]]">{{row[column.def]}}</a>
                                    </td>
                                    <!-- For non-link columns -->
                                    <td *ngIf="!column.isLink && column.visible">{{ row[column.def] }}</td>
                                </ng-container>
                            </tr>
                        </tbody>
                    </table>
                    <div class="noresult" [ngClass]="dataSource?.length != 0 ? 'd-none' : ''">
                        <div class="text-center py-4">
                            <i class="ph-magnifying-glass fs-1 text-primary"></i>
                            <h5 class="mt-2">Sorry! No Result Found</h5>
                            <p class="text-muted mb-0">
                                We've searched more than {{ dataSource?.length }}+ Records, We
                                did not find any Records for you search.
                            </p>
                        </div>
                    </div>
                </div>
                <!-- <div id="elmLoader" *ngIf="isLoading">
                      <div class="spinner-border text-primary avatar-sm" role="status">
                        <span class="visually-hidden">Loading...</span>
                      </div>
                    </div> -->
                <div [ngClass]="dataSource?.length === 0 ? 'd-none' : ''" class="row align-items-center mt-4 pt-2"
                    id="pagination-element">
                    <div class="col-sm-auto" style="padding-bottom: 13px;">
                        <div class="text-muted text-center text-sm-start pe-auto">
                            Per Page:
                        </div>
                    </div>
                    <div class="col-sm-auto" style="padding-bottom: 13px;">
                        <select class="form-select w-auto" id="perPage" [(ngModel)]="itemsPerPage"
                            (change)="onPerPageChange()">
                            <option *ngFor="let option of perPageOptions" [value]="option">
                                {{ option }}
                            </option>
                        </select>
                    </div>
                    <div class="col-sm" style="padding-bottom: 13px;">
                        <!-- <div class="text-muted text-center text-sm-start">
                            Showing <span class="fw-semibold">{{ endIndex }}</span> of
                            <span class="fw-semibold">{{ totalRecords }}</span> Results
                        </div> -->
                        <div class="text-muted text-center text-sm-start">
                            Showing <span class="fw-semibold">{{ pagedItems.length }}</span> of
                            <span class="fw-semibold">{{ totalRecords }}</span> Results
                        </div>
                    </div>
                    <div class="col-sm-auto mt-3 mt-sm-0">
                        <pagination class="pagination-wrap hstack gap-2 justify-content-center"
                            [totalItems]="totalRecords" [itemsPerPage]="itemsPerPage" [boundaryLinks]="true"
                            [directionLinks]="true" [maxSize]="5" [(ngModel)]="currentPage" name="currentPage"
                            (pageChanged)="onPageChange(currentPage)"></pagination>
                    </div>
                </div>
            </div>

        </div>

    </div>
</div>



<div bsModal #showModal="bs-modal" class="modal fade" >
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="modal-header px-4 pt-4">
                <h5 class="modal-title" id="exampleModalLabel">OtherCost Form</h5>
                <button type="button" class="btn-close" aria-label="Close" (click)="showModal.hide()"></button>
            </div>
            <form #formRef (ngSubmit)="submitData(id)" [formGroup]="productForm" class="row g-3 needs-validation" novalidate
                autocomplete="off">
                <div class="modal-body p-4">
                    <div id="alert-error-msg" class="d-none alert alert-danger py-2"></div>
                    <input type="hidden" formControlName="id">
                    <div class="row" style="height: 75vh; overflow: auto;">
                        <div class="mb-3 col-xl-3 col-sm-12" id="Vch">
                            <div>
                                <label class="form-label">VCH<span class="text-danger">*</span></label>
                                <div class="input-group mb-3">
                                    <input type="text" id="Vch" class="form-control" value="{{Vch}}"
                                    formControlName="Vch" placeholder="VCH" [class.is-invalid]="isInvalid('Vch')" required
                                    (keyup)="ValidateControlData($event,'Vch',false,false,true,false,true)">

                                    <div *ngIf="isInvalid('Vch')" class="invalid-feedback">
                                        <div *ngIf="productForm.get('Vch')?.errors?.['required']">
                                            VCH is required.
                                        </div>                                        
                                        <div *ngIf="productForm.get('Vch')?.errors?.['invalidData']">
                                            Special characters not allowed.Alpha numeric are allowed
                                        </div>
                                        <div *ngIf="productForm.get('Vch')?.errors?.['maxLength']">
                                            Maximum length exceeded (10 characters maximum).
                                        </div>
                                    </div>                     
                                </div>                               
                            </div>
                        </div>
                        
                        <div class="mb-3 col-xl-3 col-sm-12" id="supplierName">
                            <div>
                                <label class="form-label">Supplier Name<span class="text-danger">*</span></label>
                                <div class="input-group mb-3">
                                    <input type="text" formControlName="supplierName" class="form-control" value="0"
                                        placeholder="supplierName" aria-label="supplierName"
                                        aria-describedby="form_input_group" required [class.is-invalid]="isInvalid('supplierName')" required
                                        (keyup)="ValidateControlData($event,'supplierName',false,false,true,true,true)">
                                        <div *ngIf="isInvalid('supplierName')" class="invalid-feedback">
                                            <div *ngIf="productForm.get('supplierName')?.errors?.['required']">
                                                Supplier name is required.
                                            </div>
                                            <div *ngIf="productForm.get('supplierName')?.errors?.['invalidAlpha']">
                                                Invalid character.Alpha only allowed
                                            </div>                                          
                                            <div *ngIf="productForm.get('supplierName')?.errors?.['invalidData']">
                                                Special characters not allowed. Alpha only allowed
                                            </div>
                                        </div>  
                                </div>
                            </div>
                        </div>
                        <div class="mb-3 col-xl-3 col-sm-12" id="typeOfExpense">
                            <div>
                                <label class="form-label">Type of Expense<span class="text-danger">*</span></label>
                                <select class="form-select" [disabled]="isEditMode" 
                                formControlName="typeOfExpense" aria-label="Default select example" [class.is-invalid]="isInvalid('typeOfExpense')" required 
                                value="{{typeOfExpense}}">
                                    <option value="" selected>Select</option>
                                    <option value="IT Opex">IT Opex</option>
                                    <option value="Employee Engagement">Employee Engagement</option>
                                    <option value="Communication">Communication</option>
                                    <option value="Facilities">Facilities</option>
                                    <option value="Utilities">Utilities</option>
                                    <option value="Legal and Professional Fess">Legal and Professional Fess</option>
                                    <option value="Rates and Taxes">Rates and Taxes</option>
                                    <option value="Finance Cost">Finance Cost</option>
                                    <option value="Depreciation and Amortization">Depreciation and Amortization</option>
                                    <option value="Other Expense">Other Expense</option>
                                    <option value="Other Direct Cost">Other Direct Cost</option>
                                    <option value="Selling Cost">Selling Cost</option>
                                </select>  
                                <div *ngIf="isInvalid('typeOfExpense')" class="invalid-feedback">
                                    Type of Expense is required.
                                  </div>                    
                            </div>
                        </div>
                        <div class="mb-3 col-xl-3 col-sm-12" id="serviceLine">
                            <div>
                                <label class="form-label">Service Line</label>
                                <select class="form-select" [disabled]="isEditMode" 
                                    formControlName="serviceLine" aria-label="Default select example" [(ngModel)]="selectedTypeOfExpense2" formControlName="serviceLine"
                                    value="{{serviceLine}}">
                                    <option value="" selected>Select</option>
                                    <option value="Content Composition">Content Composition</option>
                                    <option value="Editorial Solutions">Editorial Solutions</option>
                                    <option value="Multimedia Solutions">Multimedia Solutions</option>
                                    <option value="Digital Transformation">Digital Transformation</option>
                                    <option value="Project Management">Project Management</option>
                                </select>
                                <!-- <div *ngIf="isInvalid('serviceLine')" class="invalid-feedback">
                                    Service line is required.
                                  </div>      -->
                            </div>
                        </div>

                        <div class="mb-3 col-xl-3 col-sm-12" id="customer">
                            <div>
                                <label class="form-label">Customer</label>
                                <div class="input-group mb-3">
                                    <input type="text" formControlName="customer" class="form-control" value="0"
                                        placeholder="customer" aria-label="customer"
                                        aria-describedby="form_input_group"  [class.is-invalid]="isInvalid('customer')" 
                                        (keyup)="ValidateControlData($event,'customer',false,false,true,true,false)">
                    <div *ngIf="isInvalid('customer')" class="invalid-feedback">                        
                        <div *ngIf="productForm.get('customer')?.errors?.['invalidAlpha']">
                            Invalid character.Alpha only allowed
                        </div>                                          
                        <div *ngIf="productForm.get('customer')?.errors?.['invalidData']">
                            Special characters not allowed. Alpha only allowed
                        </div>
                    </div>  
                                </div>
                            </div>
                        </div>
                        <div class="mb-3 col-xl-3 col-sm-12" id="description">
                            <div>
                                <label class="form-label">Description<span class="text-danger">*</span></label>
                                <div class="input-group mb-3">
                                    <input type="text" formControlName="description" class="form-control" value="0"
                                        placeholder="description" aria-label="description"
                                        aria-describedby="form_input_group" required [class.is-invalid]="isInvalid('description')" required
                                        (keyup)="ValidateControlData($event,'description',false,false,true,true,true)">

                                        <div *ngIf="isInvalid('description')" class="invalid-feedback">
                                            <div *ngIf="productForm.get('description')?.errors?.['required']">
                                                Description is required.
                                            </div>
                                            <div *ngIf="productForm.get('description')?.errors?.['invalidAlpha']">
                                                Invalid character.Alpha only allowed
                                            </div>                                          
                                            <div *ngIf="productForm.get('description')?.errors?.['invalidData']">
                                                Special characters not allowed. Alpha only allowed
                                            </div>
                                        </div>  
                                </div>
                            </div>
                        </div>
                        <div class="mb-3 col-xl-3 col-sm-12" id="invoiceNo">
                            <div>
                                <label class="form-label">Invoice No<span class="text-danger">*</span></label>
                                <div class="input-group mb-3">
                                    <input type="text" formControlName="invoiceNo" class="form-control" value="0"
                                        placeholder="invoiceNo" aria-label="invoiceNo"
                                        aria-describedby="form_input_group" required [class.is-invalid]="isInvalid('invoiceNo')" required
                                        (keyup)="ValidateControlData($event,'invoiceNo',false,false,true,false,true)">
                                        <div *ngIf="isInvalid('invoiceNo')" class="invalid-feedback">
                                            <div *ngIf="productForm.get('invoiceNo')?.errors?.['required']">
                                                Invoice No is required.
                                            </div>
                                            <div *ngIf="productForm.get('invoiceNo')?.errors?.['invalidAlpha']">
                                                Invalid character.Alpha only allowed
                                            </div>                                          
                                            <div *ngIf="productForm.get('invoiceNo')?.errors?.['invalidData']">
                                                Special characters not allowed. Alpha only allowed
                                            </div>
                                        </div> 
                                </div>
                            </div>
                        </div>

                        <div class="mb-3 col-xl-3 col-sm-12">
                            <label class="form-label">Invoice Date<span class="text-danger">*</span></label>
                            <div class="input-group mb-3">
                                <!-- <input type="text" [(ngModel)]="modelDate" autocomplete="off" class="form-control"
                                    bsDatepicker [bsConfig]="{ containerClass :colorTheme }" id="datetimepicker2"
                                    formControlName="invoiceDate" [bsConfig]="{dateInputFormat: 'MMM YYYY'}"
                                    (onShown)="onOpenCalendar($event)"> -->
                                    <input type="date" id="invoiceDate" class="form-control" formControlName="invoiceDate" [value]="formattedInvoiceDate" (onShown)="onOpenCalendar($event)" required [class.is-invalid]="isInvalid('invoiceDate')"
                                    (keyup)="ValidateControlData($event,'invoiceDate',true,true,false,false,true)">
                                    <div *ngIf="isInvalid('invoiceDate')" class="invalid-feedback">
                                        <div *ngIf="productForm.get('invoiceDate')?.hasError('required')">
                                            Invoice date is required.
                                        </div>
                                    </div>
                            </div>

                        </div>
                        <div class="mb-3 col-xl-3 col-sm-12" id="poNo">
                            <div>
                                <label class="form-label">PO No</label>
                                <div class="input-group mb-3">
                                    <input type="text" formControlName="poNo" class="form-control" value="0"
                                        placeholder="poNo" aria-label="poNo" aria-describedby="form_input_group" [class.is-invalid]="isInvalid('poNo')"
                                        (keyup)="ValidateControlData($event,'poNo',false,false,true,false,false)">
                                        <div *ngIf="isInvalid('poNo')" class="invalid-feedback">
                                            <!-- <div *ngIf="productForm.get('poNo')?.errors?.['required']">
                                                PO no is required.
                                            </div> -->
                                            <div *ngIf="productForm.get('poNo')?.errors?.['invalidData']">
                                                Special characters not allowed.Alpha numeric are allowed
                                            </div>
                                        </div>
                                        
                                </div>
                            </div>

                        </div>

                        <div class="mb-3 col-xl-3 col-sm-12" id="poDate">
                            <div>
                                <label class="form-label">PO Date</label>
                                <div class="input-group mb-3">
                                        <input type="date" id="poDate" class="form-control" formControlName="poDate"  (onShown)="onOpenCalendar($event)"
                                        (keyup)="ValidateControlData($event,'poDate',true,true,false,false,false)">
                                        <div *ngIf="isInvalid('poDate')" class="invalid-feedback">
                                            <!-- <div *ngIf="productForm.get('poDate')?.hasError('required')">
                                                PO date is required.
                                            </div> -->
                                        </div>
                                </div>
                            </div>
                        </div>

                        <div class="mb-3 col-xl-3 col-sm-12" id="rcm">
                            <div>
                                <label class="form-label">RCM-Y/N<span class="text-danger">*</span></label>
                                <select class="form-select" [disabled]="isEditMode" 
                                    formControlName="rcm" aria-label="Default select example" required [(ngModel)]="selectedTypeOfExpense3" [class.is-invalid]="isInvalid('rcm')"
                                    value="{{rcm}}"> 
                                    <option value="" selected>Select</option>
                                    <option [ngValue]="true">Yes</option>
                                    <option [ngValue]="false">No</option>
                                </select>
                                <div *ngIf="isInvalid('rcm')" class="invalid-feedback">
                                    RCM is required.
                                </div>
                            </div>
                        </div>
                        <div class="mb-3 col-xl-3 col-sm-12" id="hsnSac">
                            <div>
                                <label class="form-label">HSN/SAC<span class="text-danger">*</span></label>
                                <div class="input-group mb-3">
                                    <input type="text" formControlName="hsnSac" class="form-control" value="0"
                                        placeholder="hsnSac" aria-label="hsnSac" aria-describedby="form_input_group"  required [class.is-invalid]="isInvalid('hsnSac')" (input)="onInputChange($event,'hsnSac')" (keyup)="ValidateControlData($event,'hsnSac',false,false,true,false,true)">
                                        <div *ngIf="isInvalid('hsnSac')" class="invalid-feedback">
                                            <div *ngIf="productForm.get('hsnSac')?.errors?.['required']">
                                                HSN/SAC is required.
                                            </div>
                                            <div *ngIf="productForm.get('hsnSac')?.errors?.['invalidData']">
                                                Special characters not allowed. Numeric only allowed
                                            </div>
                                        </div> 
                                </div>
                            </div>
                        </div>
                        <div class="mb-3 col-xl-3 col-sm-12" id="qty">
                            <div>
                                <label class="form-label">Qty<span class="text-danger">*</span></label>
                                <div class="input-group mb-3">
                                    <input type="number" formControlName="qty" class="form-control" value="0"
                                        placeholder="qty" aria-label="qty" aria-describedby="form_input_group" required [class.is-invalid]="isInvalid('qty')" (keyup)="ValidateControlData($event,'qty',false,false,false,false,true)">
                                        <div *ngIf="isInvalid('qty')" class="invalid-feedback">
                                            <div *ngIf="productForm.get('qty')?.errors?.['required']">
                                                Qty is required.
                                            </div>                               
                                            <div *ngIf="productForm.get('qty')?.errors?.['invalidData']">
                                                Special characters not allowed. Numeric only allowed
                                            </div>
                                        </div> 
                                </div>
                            </div>
                        </div>
                        <div class="mb-3 col-xl-3 col-sm-12" id="rate">
                            <div >
                                <label class="form-label">Rate<span class="text-danger">*</span></label>
                                <div class="input-group mb-3">
                                    <input type="number" formControlName="rate" class="form-control" 
                                    value="0" placeholder="rate" aria-label="rate" aria-describedby="form_input_group"
                                    required [class.is-invalid]="isInvalid('rate')" (keyup)="ValidateControlData($event,'rate',false,false,false,false,true)">
                                    <span class="input-group-text" id="form_input_group">%</span>
                                    <div *ngIf="isInvalid('rate')" class="invalid-feedback">
                                        <div *ngIf="productForm.get('rate')?.errors?.['required']">
                                            Rate is required.
                                        </div>
                                        <div *ngIf="productForm.get('rate')?.errors?.['invalidData']">
                                            Special characters not allowed. Numeric only allowed
                                        </div>
                                    </div> 
                                    
                                </div>
                
                              </div>
                        </div>
                        <div class="mb-3 col-xl-3 col-sm-12" id="value">
                            <div>
                                <label class="form-label">Value<span class="text-danger">*</span></label>
                                <div class="input-group mb-3">
                                    <input type="number" formControlName="value" class="form-control" value="0"
                                        placeholder="value" aria-label="value" aria-describedby="form_input_group"  required [class.is-invalid]="isInvalid('value')" (keyup)="ValidateControlData($event,'value',false,false,false,false,true)">
                                        <div *ngIf="isInvalid('value')" class="invalid-feedback">
                                            <div *ngIf="productForm.get('value')?.errors?.['required']">
                                                Value is required.
                                            </div>
                                            <div *ngIf="productForm.get('value')?.errors?.['invalidData']">
                                                Special characters not allowed. Numeric only allowed
                                            </div>
                                        </div> 
                                </div>
                            </div>
                        </div>
                        <div class="mb-3 col-xl-3 col-sm-12" id="fxrate">
                            <div>
                                <label class="form-label">FX Rate<span class="text-danger">*</span></label>
                                <div class="input-group mb-3">
                                    <input type="number" formControlName="fxrate" class="form-control" value="0"
                                        placeholder="fxrate" aria-label="fxrate" aria-describedby="form_input_group" required [class.is-invalid]="isInvalid('fxrate')" (keyup)="ValidateControlData($event,'fxrate',false,false,false,false,true)">
                                        <div *ngIf="isInvalid('fxrate')" class="invalid-feedback">
                                            <div *ngIf="productForm.get('fxrate')?.errors?.['required']">
                                                FX Rate is required.
                                            </div>
                                            <div *ngIf="productForm.get('fxrate')?.errors?.['invalidData']">
                                                Special characters not allowed. Numeric only allowed
                                            </div>
                                        </div> 
                                </div>
                            </div>
                        </div>
                        <div class="mb-3 col-xl-3 col-sm-12" id="valueInr">
                            <div>
                                <label class="form-label">Value - INR<span class="text-danger">*</span></label>
                                <div class="input-group mb-3">
                                    <input type="number" formControlName="valueInr" class="form-control" value="0"
                                        placeholder="valueInr" aria-label="valueInr" aria-describedby="form_input_group" required [class.is-invalid]="isInvalid('valueInr')" (keyup)="ValidateControlData($event,'valueInr',false,false,false,false,true)">
                                        <div *ngIf="isInvalid('valueInr')" class="invalid-feedback">
                                            <div *ngIf="productForm.get('valueInr')?.errors?.['required']">
                                                Value - INR is required.
                                            </div>
                                            <div *ngIf="productForm.get('valueInr')?.errors?.['invalidData']">
                                                Special characters not allowed. Numeric only allowed
                                            </div>
                                        </div> 
                                </div>
                            </div>
                        </div>
                        <div class="mb-3 col-xl-3 col-sm-12" id="vat">
                            <div>
                                <label class="form-label">VAT</label>
                                <div class="input-group mb-3">
                                    <input type="number" formControlName="vat" class="form-control" value="0"
                                        placeholder="vat" aria-label="vat" aria-describedby="form_input_group"  (keyup)="ValidateControlData($event,'vat',false,false,false,false,false)">
                                        <div *ngIf="isInvalid('vat')" class="invalid-feedback">
                                            <div *ngIf="productForm.get('vat')?.errors?.['required']">
                                                VAT is required.
                                            </div>
                                            <div *ngIf="productForm.get('vat')?.errors?.['invalidData']">
                                                Special characters not allowed. Numeric only allowed
                                            </div>
                                        </div> 
                                </div>
                            </div>
                        </div>
                        <div class="mb-3 col-xl-3 col-sm-12" id="cgst">
                            <div>
                                <label class="form-label">CGST</label>
                                <div class="input-group mb-3">
                                    <input type="number" formControlName="cgst" class="form-control" value="0"
                                        placeholder="cgst" aria-label="cgst" aria-describedby="form_input_group" (keyup)="ValidateControlData($event,'cgst',false,false,false,false,false)">
                                        <div *ngIf="isInvalid('cgst')" class="invalid-feedback">
                                            <!-- <div *ngIf="productForm.get('cgst')?.errors?.['required']">
                                                CGST is required.
                                            </div> -->
                                            <div *ngIf="productForm.get('cgst')?.errors?.['invalidData']">
                                                Special characters not allowed. Numeric only allowed
                                            </div>
                                        </div> 
                                </div>
                            </div>
                        </div>
                        <div class="mb-3 col-xl-3 col-sm-12" id="sgst">
                            <div>
                                <label class="form-label">SGST</label>
                                <div class="input-group mb-3">
                                    <input type="number" formControlName="sgst" class="form-control" value="0"
                                        placeholder="sgst" aria-label="sgst" aria-describedby="form_input_group" (keyup)="ValidateControlData($event,'sgst',false,false,false,false,false)">
                                        <div *ngIf="isInvalid('sgst')" class="invalid-feedback">
                                            <!-- <div *ngIf="productForm.get('sgst')?.errors?.['required']">
                                                SGST is required.
                                            </div> -->
                                            <div *ngIf="productForm.get('sgst')?.errors?.['invalidData']">
                                                Special characters not allowed. Numeric only allowed
                                            </div>
                                        </div> 
                                </div>
                            </div>
                        </div>
                        <div class="mb-3 col-xl-3 col-sm-12" id="igst">
                            <div>
                                <label class="form-label">IGST<span class="text-danger">*</span></label>
                                <div class="input-group mb-3">
                                    <input type="number" formControlName="igst" class="form-control" value="0"
                                        placeholder="igst" aria-label="igst" aria-describedby="form_input_group" required [class.is-invalid]="isInvalid('igst')" (keyup)="ValidateControlData($event,'igst',false,false,false,false,true)">
                                        <div *ngIf="isInvalid('igst')" class="invalid-feedback">
                                            <div *ngIf="productForm.get('igst')?.errors?.['required']">
                                                IGST is required.
                                            </div>
                                            <div *ngIf="productForm.get('igst')?.errors?.['invalidData']">
                                                Special characters not allowed. Numeric only allowed
                                            </div>
                                        </div> 
                                </div>
                            </div>
                        </div>
                        <div class="mb-3 col-xl-3 col-sm-12" id="totalInvoiceValueInr">
                            <div>
                                <label class="form-label">Total Invoice Value - INR<span class="text-danger">*</span></label>
                                <div class="input-group mb-3">
                                    <input type="number" formControlName="totalInvoiceValueInr" class="form-control" value="0"
                                        placeholder="total Invoice" aria-label="totalInvoiceValueInr" aria-describedby="form_input_group" required [class.is-invalid]="isInvalid('totalInvoiceValueInr')" (keyup)="ValidateControlData($event,'totalInvoiceValueInr',false,false,false,false,true)">
                                        <div *ngIf="isInvalid('totalInvoiceValueInr')" class="invalid-feedback">
                                            <div *ngIf="productForm.get('totalInvoiceValueInr')?.errors?.['required']">
                                                Total invoice value Inr is required.
                                            </div>
                                            <div *ngIf="productForm.get('totalInvoiceValueInr')?.errors?.['invalidData']">
                                                Special characters not allowed. Numeric only allowed
                                            </div>
                                        </div> 
                                </div>
                            </div>
                        </div>
                        <div class="mb-3 col-xl-3 col-sm-12" id="tdsApplicable">
                            <div>
                                <label class="form-label">TDS Applicable<span class="text-danger">*</span></label>
                                <select class="form-select" [disabled]="isEditMode" 
                                    formControlName="tdsApplicable" aria-label="Default select example" [(ngModel)]="selectedTypeOfExpense4" required [class.is-invalid]="isInvalid('tdsApplicable')"  formControlName="tdsApplicable"
                                    value="{{tdsApplicable}}">
                                    <option value="" selected>Select</option>
                                    <option [ngValue]="true">Yes</option>
                                    <option [ngValue]="false">No</option>
                                </select>
                                <div *ngIf="isInvalid('tdsApplicable')" class="invalid-feedback">
                                    TDS applicable is required.
                                </div>
                            </div>
                        </div>
                        <div class="mb-3 col-xl-3 col-sm-12" id="tdsDeclaration">
                            <div>
                                <label class="form-label">TDS Declaration Y/N<span class="text-danger">*</span></label>
                                <select class="form-select" [disabled]="isEditMode" 
                                    formControlName="tdsDeclaration" aria-label="Default select example" [(ngModel)]="selectedTypeOfExpense5" required [class.is-invalid]="isInvalid('tdsDeclaration')"
                                    value="{{tdsDeclaration}}">
                                    <option value="" selected>Select</option>
                                    <option [ngValue]="true">Yes</option>
                                    <option [ngValue]="false">No</option>
                                </select>
                                <div *ngIf="isInvalid('tdsDeclaration')" class="invalid-feedback">
                                    TDS declaration is required.
                                </div>
                            </div>
                        </div>
                        <div class="mb-3 col-xl-3 col-sm-12" id="tdsSection">
                            <div>
                                <label class="form-label">TDS Section </label>
                                <select class="form-select" [disabled]="isEditMode" 
                                    formControlName="tdsSection" aria-label="Default select example"
                                    [(ngModel)]="selectedTypeOfExpense6" value="{{tdsSection}}">
                                    <option [ngValue]="null" selected>Select</option>                                    
                                    <option value="193">193</option>
                                    <option value="195">195</option>                                    
                                    <option value="194A">194A</option>
                                    <option value="194C">194C</option>                                    
                                    <option value="194H">194H</option>
                                    <option value="194I">194I</option>
                                    <option value="194J">194J</option>
                                    <option value="194Q">194Q</option>
                                </select>
                                <div *ngIf="isInvalid('tdsSection')" class="invalid-feedback">
                                    TDS section is required.
                                </div>
                            </div>
                        </div>
                        <div class="mb-3 col-xl-3 col-sm-12" id="tdsRate">
                            <div>
                                <label class="form-label">TDS Rate<span class="text-danger">*</span></label>                               
                                <div class="input-group mb-3">
                                    <input type="number" formControlName="tdsRate" class="form-control" 
                                    value="0" placeholder="tdsRate" aria-label="tdsRate" aria-describedby="form_input_group"
                                    required [class.is-invalid]="isInvalid('tdsRate')" (keyup)="ValidateControlData($event,'tdsRate',false,false,false,false,true)" (keyup)="calculateTDSValue()">
                                    <span class="input-group-text" id="form_input_group">%</span>
                                    <div *ngIf="isInvalid('tdsRate')" class="invalid-feedback">
                                        <div *ngIf="productForm.get('tdsRate')?.errors?.['required']">
                                            TDS rate is required.
                                        </div>
                                        <div *ngIf="productForm.get('tdsRate')?.errors?.['invalidData']">
                                            Special characters not allowed. Numeric only allowed
                                        </div>
                                    </div> 
                                </div>
                            </div>
                        </div>
                        <div class="mb-3 col-xl-3 col-sm-12" id="tdsValue">
                            <div>
                                <label class="form-label">TDS Value<span class="text-danger">*</span></label>
                                <div class="input-group mb-3">
                                    <input type="number" formControlName="tdsValue" class="form-control" value="0"
                                        placeholder="tdsValue" aria-label="tdsValue" aria-describedby="form_input_group" required [class.is-invalid]="isInvalid('tdsValue')"  readonly>
                                        <div *ngIf="isInvalid('tdsValue')" class="invalid-feedback">
                                            <div *ngIf="productForm.get('tdsValue')?.errors?.['required']">
                                                TDS Value is required.
                                            </div>
                                            <!-- <div *ngIf="productForm.get('tdsValue')?.errors?.['invalidData']">
                                                Special characters not allowed. Numeric only allowed
                                            </div> -->
                                        </div> 
                                </div>
                            </div>
                        </div>
                        <div class="mb-3 col-xl-3 col-sm-12" id="budgeted">
                            <div>
                                <label class="form-label">Budgeted Y/N<span class="text-danger">*</span></label>
                                <select class="form-select" [disabled]="isEditMode" 
                                    formControlName="budgeted" aria-label="Default select example" [(ngModel)]="selectedTypeOfExpense7" required [class.is-invalid]="isInvalid('budgeted')" value="{{budgeted}}">
                                    <option value="" selected>Select</option>
                                    <option [ngValue]="true">Yes</option>
                                    <option [ngValue]="false">No</option>
                                </select>
                                <div *ngIf="isInvalid('budgeted')" class="invalid-feedback">
                                    Budgeted is required.
                                </div>
                            </div>
                        </div>
                        <div class="mb-3 col-xl-3 col-sm-12" id="budgetedAmount">
                            <div>
                                <label class="form-label">Budgeted Amount<span class="text-danger">*</span></label>
                                <div class="input-group mb-3">
                                    <input type="number" formControlName="budgetedAmount" class="form-control" value="0"
                                        placeholder="budgetedAmount" aria-label="budgetedAmount" aria-describedby="form_input_group" required [class.is-invalid]="isInvalid('budgetedAmount')" (keyup)="ValidateControlData($event,'budgetedAmount',false,false,false,false,true)">
                                        <div *ngIf="isInvalid('budgetedAmount')" class="invalid-feedback">
                                            <div *ngIf="productForm.get('budgetedAmount')?.errors?.['required']">
                                                Budgeted amount is required.
                                            </div>
                                            <div *ngIf="productForm.get('budgetedAmount')?.errors?.['invalidData']">
                                                Special characters not allowed. Numeric only allowed
                                            </div>
                                        </div>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3 col-xl-3 col-sm-12" id="variance">
                            <div>
                                <label class="form-label">Variance</label>
                                <div class="input-group mb-3">
                                    <input type="number" formControlName="variance" class="form-control" value="0"
                                        placeholder="variance" aria-label="variance" aria-describedby="form_input_group"  (keyup)="ValidateControlData($event,'variance',false,false,false,false,true)">
                                        <div *ngIf="isInvalid('variance')" class="invalid-feedback">
                                            <div *ngIf="productForm.get('variance')?.errors?.['invalidData']">
                                                Special characters not allowed. Numeric only allowed
                                            </div>
                                        </div>
                                </div>
                            </div>
                        </div>
                     <!-- end  -->                     
                    </div>
                </div>

                <div class="modal-footer">
                    <div class="hstack gap-2 justify-content-end">
                        <button type="button" class="btn btn-ghost-danger" (click)="closemodal()"><i
                                class="bi bi-x-lg align-baseline me-1"></i> Close</button>
                        <button type="submit" class="btn btn-success" id="add-btn">{{ !id ? 'Submit' : 'Update'
                            }}</button>
                    </div>
                </div>
            </form>
        </div>
        <!-- modal-content -->
    </div>
</div>
<!-- modal-dialog -->

<!-- deleteRecordModal -->
<div bsModal #deleteRecordModal="bs-modal" id="deleteRecordModal" class="modal fade zoom" tabindex="-1" role="dialog"
    aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="btn-close" id="deleteRecord-close"
                    (click)="deleteRecordModal.hide()"></button>
            </div>
            <div class="modal-body p-md-5">
                <div class="text-center">
                    <div class="text-danger">
                        <i class="bi bi-trash display-4"></i>
                    </div>
                    <div class="mt-4">
                        <h3 class="mb-2">Are you sure ?</h3>
                        <p class="text-muted fs-lg mx-3 mb-0">Are you sure you want to remove this record ?</p>
                    </div>
                </div>
                <div class="d-flex gap-2 justify-content-center mt-4 mb-2">
                    <button type="button" class="btn w-sm btn-light btn-hover"
                        (click)="deleteRecordModal.hide()">Close</button>
                    <button type="button" class="btn w-sm btn-danger btn-hover" id="delete-record"
                        (click)="confirmDelete()">Yes,
                        Delete It!</button>
                </div>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /deleteRecordModal -->


<!--Filters-->
<div class="custom-offcanvas" id="courseFilters">
    <div class="offcanvas-header border-bottom p-3">
        <h5 class="offcanvas-title" id="courseFiltersLabel">OtherCost Filters</h5>
        <button type="button" class="btn-close" (click)="closeoffcanvas()"></button>
    </div>
    <div class="offcanvas-body">
        <form action="#!" [formGroup]="filterForm">
            <div class="row">
                <div class="col-lg-12">
                    <div class="mb-3">
                        <label class="select-category-filter form-label fs-md mb-3 text-decoration-underline">Supplier Name</label>
                        <div class="formCost d-flex gap-2 align-items-center">
                            <input type="text" id="supplierName" formControlName="supplierName" class="form-control" aria-label="supplierName" aria-describedby="form_input_group" value={{fsupplierName}}>
                        </div>
                    </div>
                </div>
                <div class="col-lg-12">
                    <div class="mb-3">
                        <label class="select-category-filter form-label fs-md mb-3 text-decoration-underline">Type of Expense</label>
                        <div class="formCost d-flex gap-2 align-items-center">
                            <select class="form-select" id="typeOfExpense"  
                            formControlName="typeOfExpense" aria-label="Default select example" 
                            value="{{typeOfExpense}}">
                                <option value="" selected>Select</option>
                                <option value="IT Opex">IT Opex</option>
                                <option value="Employee Engagement">Employee Engagement</option>
                                <option value="Communication">Communication</option>
                                <option value="Facilities">Facilities</option>
                                <option value="Utilities">Utilities</option>
                                <option value="Legal and Professional Fess">Legal and Professional Fess</option>
                                <option value="Rates and Taxes">Rates and Taxes</option>
                                <option value="Finance Cost">Finance Cost</option>
                                <option value="Depreciation and Amortization">Depreciation and Amortization</option>
                                <option value="Other Expense">Other Expense</option>
                                <option value="Other Direct Cost">Other Direct Cost</option>
                                <option value="Selling Cost">Selling Cost</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="col-lg-12">
                    <div class="mb-3">
                        <label class="select-category-filter form-label fs-md mb-3 text-decoration-underline">Service Line</label>
                        <div class="formCost d-flex gap-2 align-items-center">
                            <select class="form-select" [disabled]="isEditMode" id="serviceLine" aria-label="Default select example" formControlName="serviceLine" value="{{serviceLine}}">
                                    <option value="" selected>Select</option>
                                    <option value="Content Composition">Content Composition</option>
                                    <option value="Editorial Solutions">Editorial Solutions</option>
                                    <option value="Multimedia Solutions">Multimedia Solutions</option>
                                    <option value="Digital Transformation">Digital Transformation</option>
                                    <option value="Project Management">Project Management</option>
                                </select>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="mb-3">
                        <label class="select-category-filter form-label fs-md mb-3 text-decoration-underline">Customer</label>
                        <div class="formCost d-flex gap-2 align-items-center">
                            <input type="text" id="customer" formControlName="customer" class="form-control" aria-label="customer" aria-describedby="form_input_group" >
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="mb-3">
                        <label class="select-category-filter form-label fs-md mb-3 text-decoration-underline">Invoice No</label>
                        <div class="formCost d-flex gap-2 align-items-center">
                            <input type="text" id="invoiceNo" formControlName="invoiceNo" class="form-control" aria-label="invoiceNo"
                            aria-describedby="form_input_group">
                        </div>
                    </div>
                </div>
                <div class="col-lg-12">
                    <div class="mb-3">
                        <label class="select-category-filter form-label fs-md mb-3 text-decoration-underline">Invoice Date</label>
                        <div class="formCost d-flex gap-2 align-items-center">
                            <input type="date"  id="invoiceDate" class="form-control" formControlName="invoiceDate" [value]="formattedInvoiceDate" (onShown)="onOpenCalendar($event)">
                        </div>
                    </div>
                </div>
                <div class="col-lg-12">
                    <div class="mb-3">
                        <label class="select-category-filter form-label fs-md mb-3 text-decoration-underline">PO No</label>
                        <div class="formCost d-flex gap-2 align-items-center">
                            <input type="text" id="poNo" formControlName="poNo" class="form-control" aria-label="poNo" aria-describedby="form_input_group">
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
    <div class="offcanvas-header htsack gap-2 border-top p-3">
        <button class="btn btn-subtle-danger w-100" (click)="resetFilter()"><i
                class="bi bi-x-lg align-baseline me-1"></i>
            Reset</button>
        <button class="btn btn-secondary w-100" (click)="submitFilter()"><i class="bi bi-funnel align-baseline me-1"></i>
            Filters</button>
    </div>
</div>




<div class="modal " id="loaderAnimation">
    <div class="modal-dialog" role="document" style=" display: flex; justify-content: center; align-items: center;">
        <div class="modal-content card" style="background-color: transparent !important;">

            <div class="h-100 p-4  d-flex justify-content-center align-items-center flex-column">

                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                    style="margin: auto; background: rgba(255, 255, 255, 0); display: block;" width="203px"
                    height="203px" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">
                    <circle cx="50" cy="50" r="0" fill="none" stroke="#e90c59" stroke-width="4">
                        <animate attributeName="r" repeatCount="indefinite" dur="3.571428571428571s" values="0;40"
                            keyTimes="0;1" keySplines="0 0.2 0.8 1" calcMode="spline" begin="0s"></animate>
                        <animate attributeName="opacity" repeatCount="indefinite" dur="3.571428571428571s" values="1;0"
                            keyTimes="0;1" keySplines="0.2 0 0.8 1" calcMode="spline" begin="0s">
                        </animate>
                    </circle>
                    <circle cx="50" cy="50" r="0" fill="none" stroke="#46dff0" stroke-width="4">
                        <animate attributeName="r" repeatCount="indefinite" dur="3.571428571428571s" values="0;40"
                            keyTimes="0;1" keySplines="0 0.2 0.8 1" calcMode="spline" begin="-1.7857142857142856s">
                        </animate>
                        <animate attributeName="opacity" repeatCount="indefinite" dur="3.571428571428571s" values="1;0"
                            keyTimes="0;1" keySplines="0.2 0 0.8 1" calcMode="spline" begin="-1.7857142857142856s">
                        </animate>
                    </circle>
                </svg>

                <h3>Loading</h3>

            </div>
        </div>
    </div>

</div>