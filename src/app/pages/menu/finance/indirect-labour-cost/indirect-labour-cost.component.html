<!-- Start Breadcrumbs -->
<app-breadcrumbs title="InDirect Labour Cost" [breadcrumbItems]="breadCrumbItems"></app-breadcrumbs>
<!-- End Breadcrumbs -->

<div class="row">
    <div class="col-lg-12">
        <div class="card" id="InDirectCostList">
            <div class="card-body">
                <div class="row align-items-center g-2">
                    <div class="col-lg-3 me-auto">
                        <div class="d-flex align-items-center">
                            <!-- <label>
                      <h4 _ngcontent-ng-c141272207="" class="card-title">Key Performance Indicators List
                      </h4>
                    </label> -->


                        </div>
                    </div>

                    <div class="col-lg-auto">
                        <div class="hstack flex-wrap gap-1">
                            <!-- <button class="btn btn-subtle-danger d-none" id="remove-actions"><i class="ri-delete-bin-2-line"></i></button> -->

                            <div _ngcontent-ng-c141272207="" class="">
                                <div _ngcontent-ng-c141272207="" class="search-box">
                                    <input _ngcontent-ng-c141272207="" type="text"
                                        placeholder="Search for Department,Branch,FC,Fx Rate"
                                        class="form-control search ng-pristine ng-valid ng-touched"
                                        [(ngModel)]="searchTerm" (keyup)="onSearchKeyUp(searchTerm)">
                                    <i _ngcontent-ng-c141272207="" class="ri-search-line search-icon"></i>
                                </div>
                            </div>

                            <button [hidden]="!menucanadd" name="{{menucanadd}}" type="button"
                                class="btn btn-primary add-btn" (click)="openModal()"><i
                                    class="bi bi-plus-circle align-baseline me-1"></i> Add InDirectLabourCost</button>
                            <button type="button" class="btn btn-info me-1" (click)="openEnd()"><i
                                    class="bi bi-funnel align-baseline me-1"></i> Filter</button>
                            <div>
                               
                                <div dropdown class="btn-group">
                                    <button dropdownToggle class="btn btn-success me-1" type="button"
                                        id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                                        <i class="ph-cloud-arrow-up align-middle me-1"></i>
                                        Export
                                    </button>
                                    <ul *dropdownMenu class="dropdown-menu dropdown-menu-end dropdown-menu-lg-start"
                                        aria-labelledby="dropdownMenuButton">
                                        <li>
                                            <button class="dropdown-item btn-link" type="button"
                                                (click)="exportToExcel()">
                                                <i class="bi bi-filetype-xls fs-4 me-1"></i>
                                                <span>Excel</span>
                                            </button>
                                        </li>
                                        <li class="mt-1">
                                            <button class="dropdown-item btn-link" type="button"
                                                (click)="exportToCsv()">
                                                <i class="bi bi-filetype-csv fs-4 me-1"></i>
                                                <span>CSV</span>
                                            </button>
                                        </li>
                                        <li class="mt-1">
                                            <button class="dropdown-item btn-link" type="button"
                                                (click)="exportToPDF()">
                                                <i class="bi bi-filetype-pdf fs-4 me-1"></i>
                                                <span>PDF</span>
                                            </button>
                                        </li>
                                        <li class="mt-1">
                                            <button class="dropdown-item btn-link" type="button"
                                                (click)="exportToExcelAll()">
                                                <i class="bi bi-filetype-pdf fs-4 me-1"></i>
                                                <span>Excel All</span>
                                            </button>
                                        </li>
                                        <li class="mt-1">
                                            <button class="dropdown-item btn-link" type="button"
                                                (click)="exportToCsvAll()">
                                                <i class="bi bi-filetype-pdf fs-4 me-1"></i>
                                                <span>Csv All</span>
                                            </button>
                                        </li>
                                        <li class="mt-1">
                                            <button class="dropdown-item btn-link" type="button"
                                                (click)="exportToPDFAll()">
                                                <i class="bi bi-filetype-pdf fs-4 me-1"></i>
                                                <span>PDF All</span>
                                            </button>
                                        </li>

                                    </ul>
                                </div>

                                <div dropdown class="btn-group" [hidden]="!menucanupdate && !menucandelete">


                                    <button dropdownToggle class="btn btn-primary me-1" type="button"
                                        id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false"
                                        [class.disabled]="!areMultipleRowsSelected()">
                                        <i class="bi bi-three-dots-vertical"></i>
                                    </button>
                                    <ul *dropdownMenu class="dropdown-menu" aria-labelledby="dropdownMenuButton">

                                        <li [hidden]="!menucanupdate" class="mt-1">
                                            <button class="dropdown-item btn-link" type="button" (click)="editList()"
                                                [disabled]="!isSingleRowSelected()">
                                                <i class="bi bi-pencil-square"></i> Edit
                                            </button>
                                        </li>
                                        <li [hidden]="!menucandelete" class="mt-1">
                                            <button class="dropdown-item btn-link" type="button"
                                                (click)="deleteRecordModal.show()" [disabled]="!isSingleRowSelected()">
                                                <i class="bi bi-trash"></i> Delete
                                            </button>
                                        </li>

                                    </ul>
                                </div>
                                <div dropdown class="btn-group me-1" (click)="onDropdownClick($event)">
                                    <button dropdownToggle type="button" class="btn btn-subtle-danger"
                                        data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        <i class="mdi mdi-cog-outline text-muted fs-lg align-middle me-1"></i>
                                    </button>
                                    <div *dropdownMenu
                                        class="dropdown-menu dropdown-menu-end dropdown-menu-lg-start p-2"
                                        (click)="onDropdownMenuClick($event)">
                                        <label *ngFor="let item of columnDefinitions" class="dropdown-item">
                                            <input type="checkbox" [(ngModel)]="item.visible"
                                                (click)="onColumnToggleChange(item)" [disabled]="item.disableHide" />
                                            {{ item.label }}
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card-body">
                <div class="table-responsive table-card table-container">
                    <table class="table table-centered align-middle table-custom-effect table-nowrap mb-0">
                        <thead class="text-muted">
                            <tr>
                                <th>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" [(ngModel)]="masterSelected"
                                            (change)="checkUncheckAll($event)" />
                                        <label class="form-check-label"></label>
                                    </div>
                                </th>
                                <ng-container *ngFor="let column of columnDefinitions">
                                    <th class="sort cursor-pointer"
                                        [ngClass]="{ 'sort cursor-pointer': column.sortable }" *ngIf="column.visible"
                                        (click)="sort(column.def)">

                                        <span class="col-sm-auto"> {{ column.label }} </span>

                                        <span *ngIf="column.sortable"> </span>
                                        <div class="input-group input-group-sm" style="width: 100px"
                                            *ngIf="column.filterable">
                                        </div>
                                    </th>
                                </ng-container>
                            </tr>
                        </thead>
                        <tbody class="list form-check-all">
                            <tr *ngFor="let row of filteredItems()" [class.selected-row]="row.isSelected"
                                (click)="handleRowClick($event, row)">
                                <td>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" [(ngModel)]="row.state"
                                            [checked]="row.isSelected" (change)="onCheckboxChange($event, row)" />
                                        <label class="form-check-label"></label>
                                    </div>
                                </td>
                                <ng-container *ngFor="let column of columnDefinitions">
                                    <td *ngIf="column.isLink && column.visible">
                                        <a class="fw-medium link-primary"
                                            [routerLink]="['/purchase/consignment/edit/', row[column?.id]]">{{row[column.def]}}</a>
                                    </td>
                                    <!-- For non-link columns -->
                                    <td *ngIf="!column.isLink && column.visible">{{ row[column.def] }}</td>
                                </ng-container>
                            </tr>
                        </tbody>
                    </table>
                    <div class="noresult" [ngClass]="dataSource?.length != 0 ? 'd-none' : ''">
                        <div class="text-center py-4">
                            <i class="ph-magnifying-glass fs-1 text-primary"></i>
                            <h5 class="mt-2">Sorry! No Result Found</h5>
                            <p class="text-muted mb-0">
                                We've searched more than {{ dataSource?.length }}+ Records, We
                                did not find any Records for you search.
                            </p>
                        </div>
                    </div>
                </div>
                <!-- <div id="elmLoader" *ngIf="isLoading">
                      <div class="spinner-border text-primary avatar-sm" role="status">
                        <span class="visually-hidden">Loading...</span>
                      </div>
                    </div> -->
                <div [ngClass]="{'d-none': !dataSource?.length}" class="row align-items-center mt-4 pt-2"
                    id="pagination-element">
                    <div class="col-sm-auto" style="padding-bottom: 13px;">
                        <div class="text-muted text-center text-sm-start pe-auto">
                            Per Page:
                        </div>
                    </div>
                    <div class="col-sm-auto" style="padding-bottom: 13px;">
                        <select class="form-select w-auto" id="perPage" [(ngModel)]="itemsPerPage"
                            (change)="onPerPageChange()">
                            <option *ngFor="let option of perPageOptions" [value]="option">
                                {{ option }}
                            </option>
                        </select>
                    </div>
                    <div class="col-sm" style="padding-bottom: 13px;">
                        <div class="text-muted text-center text-sm-start">
                            Showing <span class="fw-semibold">{{ filteredItems().length }}</span> of
                            <span class="fw-semibold">{{ totalRecords }}</span> Results
                        </div>
                    </div>
                    <div class="col-sm-auto mt-3 mt-sm-0">
                        <pagination class="pagination-wrap hstack gap-2 justify-content-center"
                            [totalItems]="totalRecords" [itemsPerPage]="itemsPerPage" [boundaryLinks]="true"
                            [directionLinks]="true" [maxSize]="5" [(ngModel)]="currentPage" name="currentPage"
                            (pageChanged)="onPageChange(currentPage)"></pagination>
                    </div>
                </div>
            </div>

        </div>

    </div>
</div>



<div class="modal fade" bsModal #showModal="bs-modal">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="modal-header px-4 pt-4">
                <h5 class="modal-title" id="exampleModalLabel">InDirect Labour Cost Form &nbsp;&nbsp; <button type="button" (click)="showImportExcel()" [hidden]="!menucanadd"
                    class="btn btn-dark">
                    <i class="ph-cloud-arrow-down align-middle me-1"></i> Import
                </button></h5>
                <button type="button" class="btn-close" (click)="closemodal()"></button>
            </div>
            <form (ngSubmit)="submitData(id)" [formGroup]="productForm" class="row g-3 needs-validation" novalidate
                autocomplete="off">
                <div class="modal-body p-4">
                    <div id="alert-error-msg" class="d-none alert alert-danger py-2"></div>
                    <input type="hidden" formControlName="id">
                    <div class="row">
                        <div class="mb-3 col-xl-4 col-sm-12">
                            <label class="form-label">Month & Year<span class="text-danger">*</span></label>
                            <div class="input-group mb-3">
                                <input type="text" [(ngModel)]="modelDate" autocomplete="off" class="form-control" placeholder="Select Month & Year"
                                    bsDatepicker [bsConfig]="{ containerClass :colorTheme }" id="datetimepicker2"
                                    formControlName="year" [bsConfig]="{dateInputFormat: 'MMM YYYY'}"
                                    (onShown)="onOpenCalendar($event)" [class.is-invalid]="isInvalid('year')"
                                    (keyup)="ValidateControlData($event,'year',true,true,false,false)">

                                <span class="input-group-text" id="form_input_group"><i
                                        class="bi bi-calendar3"></i></span>
                                <div *ngIf="isInvalid('year')" class="invalid-feedback">
                                    <div *ngIf="productForm.get('year')?.errors?.['required']">
                                        Please choose Month&Year
                                    </div>
                                </div>
                            </div>

                        </div>

                        <div class="mb-3 col-xl-4 col-sm-12" id="department">
                            <div>
                                <label class="form-label">Department<span class="text-danger">*</span></label>
                                <div class="input-group mb-3">
                                    <input type="text" formControlName="department" class="form-control" value="0"
                                        placeholder="Department" aria-label="Department"
                                        aria-describedby="form_input_group" [class.is-invalid]="isInvalid('department')"
                                        (keyup)="ValidateControlData($event,'department',true,true,true,false)"
                                        required>
                                    <div *ngIf="isInvalid('department')" class="invalid-feedback">
                                        <div *ngIf="productForm.get('department')?.errors?.['required']">
                                            Department is required.
                                        </div>
                                        <div *ngIf="productForm.get('department')?.errors?.['invalidNumber']">
                                            Department should not conatain only numbers.
                                        </div>
                                        <div *ngIf="productForm.get('department')?.errors?.['invalidData']">
                                            Special characters not allowed.
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <div class="mb-3 col-xl-4 col-sm-12" id="FC">
                            <div>
                                <label class="form-label">Branch<span class="text-danger">*</span></label>
                                <div class="input-group mb-3">
                                    <input type="text" formControlName="branch" class="form-control" value="0"
                                        placeholder="Branch" aria-label="Branch" aria-describedby="form_input_group"
                                        [class.is-invalid]="isInvalid('branch')"
                                        (keyup)="ValidateControlData($event,'branch',true,true,true,true)" required>
                                    <div *ngIf="isInvalid('branch')" class="invalid-feedback">
                                        <div *ngIf="productForm.get('branch')?.errors?.['required']">
                                            Brach is required.
                                        </div>
                                        <div *ngIf="productForm.get('branch')?.errors?.['invalidData']">
                                            Special characters not allowed.
                                        </div>
                                        <div *ngIf="productForm.get('branch')?.errors?.['invalidNumber']">
                                            Branch should not conatain only numbers.
                                        </div>
                                        <div *ngIf="productForm.get('branch')?.errors?.['invalidAlpha']">
                                            Branch should only be Alphabets.
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>


                        <div class="mb-3 col-xl-4 col-sm-12" id="FC">
                            <div>
                                <label class="form-label">FC<span class="text-danger">*</span></label>
                                <div class="input-group mb-3">
                                    <input type="text" formControlName="fc" class="form-control" value="0"
                                        placeholder="FC" aria-label="FC" aria-describedby="form_input_group"
                                        [class.is-invalid]="isInvalid('fc')"
                                        (keyup)="ValidateControlData($event,'fc',true,true,true,true)" required>
                                    <div *ngIf="isInvalid('fc')" class="invalid-feedback">
                                        <div *ngIf="productForm.get('fc')?.errors?.['required']">
                                            Fc is required.
                                        </div>
                                        <div *ngIf="productForm.get('fc')?.errors?.['invalidData']">
                                            Special characters not allowed.
                                        </div>
                                        <div *ngIf="productForm.get('fc')?.errors?.['invalidNumber']">
                                            FC should not conatain only numbers.
                                        </div>
                                        <div *ngIf="productForm.get('fc')?.errors?.['invalidAlpha']">
                                            FC should only be Alphabets.
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <div class="mb-3 col-xl-4 col-sm-12" id="FXRate">
                            <div>
                                <label class="form-label">FX Rate<span class="text-danger">*</span></label>
                                <div class="input-group mb-3">
                                    <input type="number" formControlName="fxRate" class="form-control" value="0"
                                        placeholder="FXRate" aria-label="FXRate" aria-describedby="form_input_group"
                                        [class.is-invalid]="isInvalid('fxRate')"
                                        (keyup)="ValidateControlData($event,'fxRate',false,false,false,false)" required>
                                    <div *ngIf="isInvalid('fxRate')" class="invalid-feedback">
                                        <div *ngIf="productForm.get('fxRate')?.errors?.['required']">
                                            FxRate is required.
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <div class="mb-3 col-xl-4 col-sm-12" id="CostCTC">
                            <div>
                                <label class="form-label">Cost(CTC)<span class="text-danger">*</span></label>
                                <div class="input-group mb-3">
                                    <input type="number" formControlName="costCtc" class="form-control" value="0"
                                        placeholder="CostCTC" aria-label="CostCTC" aria-describedby="form_input_group"
                                        [class.is-invalid]="isInvalid('costCtc')"
                                        (keyup)="ValidateControlData($event,'costCtc',true,false,false,false)" required>
                                    <div *ngIf="isInvalid('costCtc')" class="invalid-feedback">
                                        <div *ngIf="productForm.get('costCtc')?.errors?.['required']">
                                            CostCTC is required.
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <div class="mb-3 col-xl-4 col-sm-12" id="noOfManDate">
                            <div>
                                <label class="form-label">No.of.Man.Days<span class="text-danger">*</span></label>
                                <div class="input-group mb-3">
                                    <input type="text" formControlName="noOfManDate" class="form-control" value="0"
                                        placeholder="Department" aria-label="Department"
                                        aria-describedby="form_input_group"
                                        [class.is-invalid]="isInvalid('noOfManDate')"
                                        (keyup)="ValidateControlData($event,'noOfManDate',true,false,true,false)"
                                        required>
                                    <div *ngIf="isInvalid('noOfManDate')" class="invalid-feedback">
                                        <div *ngIf="productForm.get('noOfManDate')?.errors?.['required']">
                                            No.Of.ManDays is required.
                                        </div>
                                        <!-- <div *ngIf="productForm.get('noOfManDate')?.errors?.['invalidNumber']">
                                            Department should not conatain only numbers.
                                        </div> -->
                                        <div *ngIf="productForm.get('noOfManDate')?.errors?.['invalidData']">
                                            Special characters not allowed.
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <div class="hstack gap-2 justify-content-end">
                        <button type="button" class="btn btn-ghost-danger" (click)="closemodal()"><i
                                class="bi bi-x-lg align-baseline me-1"></i> Close</button>
                        <button type="submit" class="btn btn-success" id="add-btn">{{ !id ? 'Submit' : 'Update'
                            }}</button>
                    </div>
                </div>
            </form>
        </div>
        <!-- modal-content -->
    </div>
</div>
<!-- modal-dialog -->

<!-- deleteRecordModal -->
<div bsModal #deleteRecordModal="bs-modal" id="" class="modal fade zoom" tabindex="-1" role="dialog"
    aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="btn-close" id="deleteRecord-close"
                    (click)="deleteRecordModal.hide()"></button>
            </div>
            <div class="modal-body p-md-5">
                <div class="text-center">
                    <div class="text-danger">
                        <i class="bi bi-trash display-4"></i>
                    </div>
                    <div class="mt-4">
                        <h3 class="mb-2">Are you sure ?</h3>
                        <p class="text-muted fs-lg mx-3 mb-0">Are you sure you want to remove this record ?</p>
                    </div>
                </div>
                <div class="d-flex gap-2 justify-content-center mt-4 mb-2">
                    <button type="button" class="btn w-sm btn-light btn-hover"
                        (click)="deleteRecordModal.hide()">Close</button>
                    <button type="button" class="btn w-sm btn-danger btn-hover" id="delete-record"
                        (click)="confirmDelete()">Yes,Delete It!</button>
                </div>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /deleteRecordModal -->


<!--Filters-->
<div class="custom-offcanvas" id="courseFilters">
    <div class="offcanvas-header border-bottom p-3 d-flex justify-content-between align-items-center">
        <h5 class="offcanvas-title" id="courseFiltersLabel">InDirectLabourCost Filters</h5>
        <button type="button" class="btn-close" (click)="closeoffcanvas()"></button>
    </div>
    <div class="offcanvas-body">
        <form action="#!">
            <div class="row">

                <div class="col-lg-12">
                    <div class="mb-3">
                        <label
                            class="select-category-filter form-label fs-md mb-3 text-decoration-underline">Department</label>
                        <div class="input-group mb-3">
                            <input type="text" formControlName="department" class="form-control" id="Fdepartment"
                                placeholder="Department" aria-label="department" aria-describedby="form_input_group">
                        </div>
                    </div>
                </div>


                <div class="col-lg-12">
                    <div class="mb-3">
                        <label class="select-category-filter form-label fs-md mb-3 text-decoration-underline">FC</label>
                        <div class="input-group mb-3">
                            <input type="text" formControlName="fc" class="form-control" placeholder="FC" id="Ffc"
                                aria-label="Fc" aria-describedby="form_input_group">
                            <!-- <div *ngIf="formsubmit && form['Communication'].errors" class="invalid-feedback">
                    Please enter communication
                </div> -->
                        </div>
                    </div>

                </div>
                <div class="col-lg-12">
                    <div class="mb-3">
                        <label
                            class="select-category-filter form-label fs-md mb-3 text-decoration-underline">Branch</label>
                        <div class="input-group mb-3">
                            <input type="text" formControlName="branch" class="form-control" placeholder="Branch"
                                id="Fbranch" aria-label="Branch" aria-describedby="form_input_group">
                            <!-- <div *ngIf="formsubmit && form['Communication'].errors" class="invalid-feedback">
                    Please enter communication
                </div> -->
                        </div>
                    </div>

                </div>


            </div>
        </form>
    </div>
    <div class="offcanvas-header htsack gap-2 border-top p-3">
        <button class="btn btn-subtle-danger w-100" (click)="resetFilter()"><i
                class="bi bi-x-lg align-baseline me-1"></i>
            Reset</button>
        <button class="btn btn-secondary w-100" (click)="submitFilter()"><i
                class="bi bi-funnel align-baseline me-1"></i>
            Filters</button>
    </div>
</div>




<div class="modal " id="loaderAnimation">
    <div class="modal-dialog" role="document" style=" display: flex; justify-content: center; align-items: center;">
        <div class="modal-content card" style="background-color: transparent !important;">

            <div class="h-100 p-4  d-flex justify-content-center align-items-center flex-column">

                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                    style="margin: auto; background: rgba(255, 255, 255, 0); display: block;" width="203px"
                    height="203px" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">
                    <circle cx="50" cy="50" r="0" fill="none" stroke="#e90c59" stroke-width="4">
                        <animate attributeName="r" repeatCount="indefinite" dur="3.571428571428571s" values="0;40"
                            keyTimes="0;1" keySplines="0 0.2 0.8 1" calcMode="spline" begin="0s"></animate>
                        <animate attributeName="opacity" repeatCount="indefinite" dur="3.571428571428571s" values="1;0"
                            keyTimes="0;1" keySplines="0.2 0 0.8 1" calcMode="spline" begin="0s">
                        </animate>
                    </circle>
                    <circle cx="50" cy="50" r="0" fill="none" stroke="#46dff0" stroke-width="4">
                        <animate attributeName="r" repeatCount="indefinite" dur="3.571428571428571s" values="0;40"
                            keyTimes="0;1" keySplines="0 0.2 0.8 1" calcMode="spline" begin="-1.7857142857142856s">
                        </animate>
                        <animate attributeName="opacity" repeatCount="indefinite" dur="3.571428571428571s" values="1;0"
                            keyTimes="0;1" keySplines="0.2 0 0.8 1" calcMode="spline" begin="-1.7857142857142856s">
                        </animate>
                    </circle>
                </svg>

                <h3>Loading</h3>

            </div>
        </div>
    </div>

</div>


<!-- /Import excel modal -->
<div class="modal fade bd-example-modal-xl" id="ImportExcelPopUp">
    <div class="modal-dialog modal-xl modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-light p-1">
                <h5 class="modal-title" id="exampleModalLabel">
                    <i class="fa fa-user-circle"></i> &nbsp; Import Excel
                </h5>
                <button type="button" class="btn-close" (click)="hideImportExcel()"></button>
            </div>
            <form (ngSubmit)="ImportExcelData()" [formGroup]="productForm" class="tablelist-form" novalidate
                autocomplete="off">
                <div class="modal-body">
                    <div id="alert-error-msg" class="d-none alert alert-danger py-2"></div>
                    <!-- Input field for ID -->
                    <input type="hidden" formControlName="id">
                    <div class="row g-3">

                        <div class="col-sm-6">
                            <input type="file" (change)="onFileChange($event)" class="form-control">
                        </div>


                        <div class="col-sm-6">
                            <input type="button" value="Upload" (click)="validateExcel()"
                                class=" btn btn-subtle-primary">
                        </div>

                    </div>
                </div>
                <div class="table-responsive p-1">
                    <table class="table table-centered align-middle mb-0">
                        <thead class="table-light">
                            <tr>

                                <th scope="col" class="">
                                    Year
                                </th>
                                <th scope="col" class="">
                                    Department
                                </th>
                                <th scope="col" class="">
                                    FC
                                </th>
                                <th scope="col" class="">
                                    FxRate
                                </th>
                                <th scope="col" class="">
                                    CostCTC
                                </th>
                                <th scope="col" class="">
                                    Branch
                                </th>
                                <th scope="col" class="">
                                    NoOfManDays
                                </th>
                                <th scope="col" class="">
                                    Action
                                </th>
                            </tr>
                        </thead>
                        <tbody *ngFor="let dc of inDirectCostValidationList; let i=index" class="list form-check-all"
                            id="invoice-list-data">
                            <tr>

                                <td>{{dc.year}}</td>
                                <td>{{dc.department}}</td>
                                <td>{{dc.fc}}</td>
                                <td>{{dc.fxRate}}</td>
                                <td>{{dc.costCtc}}</td>
                                <td>{{dc.branch}}</td>
                                <td>{{dc.noOfManDate}}</td>

                                <td>
                                    <i *ngIf="dc.action" class="bi bi-check-circle-fill"
                                        style="color: rgb(121, 206, 121); font-size:15px"></i>

                                    <i *ngIf="!dc.action" class="bi bi-x-circle-fill"
                                        style="color: rgb(215, 104, 104); font-size: 15px;"></i>
                                </td>
                            </tr>

                        </tbody><!-- end tbody -->
                    </table><!-- end table -->


                </div>
                <div class="modal-footer">
                    <div class="hstack gap-2 justify-content-end">
                        <button type="button" class="btn btn-light" (click)="hideImportExcel()">Close</button>
                        <button type="submit" class="btn btn-success" (click)="importExceltoDb()" id="add-btn">
                            Import
                        </button>
                    </div>
                </div>
            </form>

        </div>
    </div>
</div>
<!-- /Import excel modal -->